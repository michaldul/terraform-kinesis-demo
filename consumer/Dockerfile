FROM ubuntu

# Install OpenJDK-8
RUN apt-get update && \
    apt-get install -y openjdk-8-jdk python3 python3-pip && \
    apt-get install -y ant && \
    apt-get clean;

# Fix certificate issues
RUN apt-get update && \
    apt-get install ca-certificates-java && \
    apt-get clean && \
    update-ca-certificates -f;

# Setup JAVA_HOME -- useful for docker commandline
ENV JAVA_HOME /usr/lib/jvm/java-8-openjdk-amd64/
RUN export JAVA_HOME

RUN ln -s /usr/bin/python3 /usr/bin/python

WORKDIR /usr/src/app

COPY requirements.txt .
RUN pip3 install --no-cache-dir -r requirements.txt

COPY . .

#CMD AWS_ACCESS_KEY_ID=x AWS_SECRET_ACCESS_KEY=x python3 amazon_kclpy_helper.py --print_command -p sample.properties --java $JAVA_HOME
CMD AWS_REGION=eu-central-1 AWS_ACCESS_KEY_ID=x AWS_SECRET_ACCESS_KEY=x /usr/lib/jvm/java-8-openjdk-amd64/bin/java -cp /usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/amazon-kinesis-client-2.1.2.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/netty-transport-4.1.32.Final.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/ion-java-1.0.2.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/commons-io-2.6.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/netty-codec-http-4.1.32.Final.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/aws-core-2.4.0.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/flow-1.7.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/dynamodb-2.4.0.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/profiles-2.4.0.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/httpclient-4.5.6.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/jsr305-3.0.2.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/error_prone_annotations-2.1.3.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/annotations-2.4.0.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/netty-codec-4.1.32.Final.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/netty-transport-native-unix-common-4.1.32.Final.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/netty-nio-client-2.4.0.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/jackson-core-2.9.8.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/commons-codec-1.10.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/commons-beanutils-1.9.3.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/commons-lang3-3.8.1.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/joda-time-2.8.1.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/rxjava-2.1.14.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/kinesis-2.4.0.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/netty-reactive-streams-http-2.0.0.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/sts-2.4.0.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/aws-cbor-protocol-2.4.0.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/guava-26.0-jre.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/amazon-kinesis-client-multilang-2.1.2.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/utils-2.4.0.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/auth-2.4.0.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/protocol-core-2.4.0.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/netty-common-4.1.32.Final.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/aws-query-protocol-2.4.0.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/jackson-dataformat-cbor-2.9.8.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/netty-reactive-streams-2.0.0.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/jackson-databind-2.9.8.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/http-client-spi-2.4.0.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/apache-client-2.4.0.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/httpcore-4.4.10.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/netty-handler-4.1.32.Final.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/reactive-streams-1.0.2.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/netty-transport-native-epoll-4.1.32.Final.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/checker-qual-2.5.2.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/j2objc-annotations-1.1.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/aws-json-protocol-2.4.0.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/slf4j-api-1.7.25.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/cloudwatch-2.4.0.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/animal-sniffer-annotations-1.14.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/protobuf-java-2.6.1.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/netty-resolver-4.1.32.Final.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/commons-collections4-4.2.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/commons-logging-1.1.3.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/jcommander-1.72.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/jackson-annotations-2.9.0.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/commons-collections-3.2.2.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/aws-java-sdk-core-1.11.477.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/logback-core-1.2.3.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/logback-classic-1.2.3.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/regions-2.4.0.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/sdk-core-2.4.0.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/netty-codec-http2-4.1.32.Final.jar:/usr/local/lib/python3.6/dist-packages/amazon_kclpy/jars/netty-buffer-4.1.32.Final.jar:/usr/src/app software.amazon.kinesis.multilang.MultiLangDaemon --properties-file sample.properties
